#include <Arduino.h>
// const char index_html[] PROGMEM = R"rawliteral()rawliteral";
// const char index_html[] PROGMEM = R"rawliteral()rawliteral";
// const char index_html[] PROGMEM = R"rawliteral()rawliteral";
const char index_html[] PROGMEM = R"rawliteral(<!DOCTYPE html> <html>  <head>   <meta charset="UTF-8">   <meta name="viewport" content="width=device-width, initial-scale=1.0">   <title>Joystick 2D</title>   <style>     body {       background: #111;       color: white;       font-family: sans-serif;       display: flex;       flex-direction: column;       align-items: center;       justify-content: center;       height: 100vh;       overflow: hidden;       touch-action: none;     }      .joystick-container {       position: relative;       width: 200px;       height: 200px;       background: #222;       border: 3px solid #555;       border-radius: 17%;       display: flex;       align-items: center;       justify-content: center;       touch-action: none;       user-select: none;     }      .stick {       position: absolute;       width: 60px;       height: 60px;       background: #00bcd4;       border-radius: 50%;       transition: 0.05s;       cursor: grab;     }      /* switch styling */     .switch {       position: relative;       display: inline-block;       width: 60px;       height: 34px;       margin-top: 20px;     }      .switch input {       opacity: 0;       width: 0;       height: 0;     }      .slider {       position: absolute;       cursor: pointer;       top: 0;       left: 0;       right: 0;       bottom: 0;       background-color: #555;       transition: 0.4s;       border-radius: 34px;     }      .slider:before {       position: absolute;       content: "";       height: 26px;       width: 26px;       left: 4px;       bottom: 4px;       background-color: white;       transition: 0.4s;       border-radius: 50%;     }      input:checked+.slider {       background-color: #0a9d48;     }      input:checked+.slider:before {       transform: translateX(26px);     }   </style> </head>  <body>   <div class="text" id="ws_info">Connecting...</div>    <div class="joystick-container" id="joystick">     <div class="stick" id="stick"></div>   </div>    <div class="text" id="coords">X: 0, Y: 0</div>    <!-- SWITCH SOTTO SENZA TESTO -->   <label class="switch">     <input type="checkbox" id="dataSwitch" checked>     <span class="slider"></span>   </label>    <script>     const ws_info = document.getElementById('ws_info');      /* websocket init */     let connection = new WebSocket("ws://192.168.4.1/ws");     /*let connection = new WebSocket("ws://127.0.0.1:81");*/      connection.onopen = function () {       ws_info.textContent = "Connected!";       ws_info.style.color = "#069c56";       connection.send("Connected device " + new Date());     };      connection.onerror = function (error) {       console.log("WebSocket Error ", error);       ws_info.textContent = `WebSocket error`;       ws_info.style.color = "#d3212c";     };          connection.onmessage = function (event) {       const mex = event.data;       if(mex=="NO_WEB"){         dataSwitch.checked = false;         dataSwitch.dispatchEvent(new Event('change'));       }      }    </script>    <script>     const dataSwitch = document.getElementById('dataSwitch');     dataSwitch.checked = false;      /*azione tasto*/     dataSwitch.addEventListener('change', () => {        if (!dataSwitch.checked) {         connection.send(`#toggle#`);       } else {         /* Riporta lo stato effettivo del websocket*/         if (connection.readyState === WebSocket.OPEN) {           ws_info.textContent = "Connected!";           ws_info.style.color = "#069c56";           connection.send(`#control#`);         }         if (connection.readyState == WebSocket.CONNECTING) {           ws_info.textContent = "Connecting...";           ws_info.style.color = "white";         }         if (connection.readyState == WebSocket.CLOSED) {           ws_info.textContent = `WebSocket error`;           ws_info.style.color = "#d3212c";         }       }     });    </script>    <script>     const joystick = document.getElementById('joystick');     const stick = document.getElementById('stick');     const coords = document.getElementById('coords');      const maxRadius = 80;     const center = { x: 100, y: 100 };     let dragging = false;     let oldX = 0;     let oldY = 0;      joystick.addEventListener('pointerdown', () => dragging = true);      document.addEventListener('pointerup', () => {       dragging = false;       stick.style.transform = `translate(0px, 0px)`;       coords.textContent = `X: 0, Y: 0`;        if (dataSwitch.checked && connection.readyState === WebSocket.OPEN)         connection.send(`#cord#X0;Y0`);     });      document.addEventListener('pointermove', (e) => {        if (!dataSwitch.checked) return;       if (!dragging) return;        const rect = joystick.getBoundingClientRect();       const x = e.clientX - rect.left - center.x;       const y = e.clientY - rect.top - center.y;        let limitedX = Math.min(Math.max(x, -maxRadius), maxRadius);       let limitedY = Math.min(Math.max(y, -maxRadius), maxRadius);        stick.style.transform = `translate(${limitedX}px, ${limitedY}px)`;        const normX = (+(limitedX / maxRadius).toFixed(1)) * 10;       const normY = (-(limitedY / maxRadius).toFixed(1)) * 10;        coords.textContent = `X: ${normX}, Y: ${normY}`;        if ((oldX != normX || oldY != normY) && dataSwitch.checked) {         oldX = normX;         oldY = normY;          if (dataSwitch.checked && connection.readyState === WebSocket.OPEN)           connection.send(`#cord#X${normX};Y${normY}`);       }     });   </script>  </body>  </html> )rawliteral";
