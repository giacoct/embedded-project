<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Joystick 2D</title>
<style>
  body {
    background: #111;
    color: white;
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  .joystick-container {
    position: relative;
    width: 200px;
    height: 200px;
    background: #222;
    border: 3px solid #555;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .stick {
    position: absolute;
    width: 60px;
    height: 60px;
    background: #00bcd4;
    border-radius: 50%;
    transition: 0.05s;
    cursor: grab;
  }

  .coords {
    margin-top: 20px;
    font-size: 1.2em;
  }
</style>
</head>
<body>

<div class="joystick-container" id="joystick">
  <div class="stick" id="stick"></div>
</div>
<div class="coords" id="coords">X: 0, Y: 0</div>

<script>
  const joystick = document.getElementById('joystick');
  const stick = document.getElementById('stick');
  const coords = document.getElementById('coords');

  const maxRadius = 70; // distanza massima dal centro
  const center = { x: 100, y: 100 }; // centro del joystick
  let dragging = false;

  joystick.addEventListener('mousedown', () => dragging = true);
  document.addEventListener('mouseup', () => {
    dragging = false;
    stick.style.transform = `translate(0px, 0px)`;
    coords.textContent = `X: 0, Y: 0`;
  });

  document.addEventListener('mousemove', (e) => {
    if (!dragging) return;

    const rect = joystick.getBoundingClientRect();
    const x = e.clientX - rect.left - center.x;
    const y = e.clientY - rect.top - center.y;

    const distance = Math.min(Math.sqrt(x*x + y*y), maxRadius);
    const angle = Math.atan2(y, x);

    const limitedX = Math.cos(angle) * distance;
    const limitedY = Math.sin(angle) * distance;

    stick.style.transform = `translate(${limitedX}px, ${limitedY}px)`;

    const normX = +(limitedX / maxRadius).toFixed(2);
    const normY = +(limitedY / maxRadius).toFixed(2);

    coords.textContent = `X: ${normX}, Y: ${normY}`;
  });
</script>

</body>
</html>